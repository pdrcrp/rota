<!doctype html>
<html lang="pt">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Percurso</title>
  <link rel="stylesheet" href="styles.css" />

  <!-- Preload das fontes -->
  <link rel="preload" href="assets/fonts/Aileron-Regular.otf" as="font" type="font/otf" crossorigin>
  <link rel="preload" href="assets/fonts/Simpsonfont%20DEMO.otf" as="font" type="font/otf" crossorigin>

  <!-- Preload das imagens do mapa (evita “piscar”/flash ao entrar na rota) -->
  <link rel="preload" as="image" href="assets/intro/01-background.webp">
  <link rel="preload" as="image" href="assets/intro/02-ruas.webp">
  <link rel="preload" as="image" href="assets/intro/03-elementos.webp">
  <link rel="preload" as="image" href="assets/intro/04-percurso.webp">
  <link rel="preload" as="image" href="assets/intro/05-icones.webp">
  <link rel="preload" as="image" href="assets/intro/06-nomes.webp">
</head>

<body>
  <!-- TOP BAR: sempre visível -->
  <header class="globalbar" id="globalBar">
    <div class="globalbar__left">
      <img class="globalbar__logo" src="assets/logo.png" alt="Postais por Lisboa" />
      <div class="globalbar__titles">
        <p class="globalbar__kicker" id="globalKicker">Postais por Lisboa</p>
        <h1 class="globalbar__title" id="globalTitle">Percurso</h1>
      </div>
    </div>

    <div class="globalbar__right">
      <button class="reset-btn" id="resetBtn" type="button" title="Recomeçar percurso">
        Recomeçar
      </button>

      <div class="lang" aria-label="Idioma">
        <button class="lang-btn" data-lang="pt" aria-pressed="true">PT</button>
        <button class="lang-btn" data-lang="en" aria-pressed="false">EN</button>
      </div>
    </div>

    <div class="globalbar__progress">
      <p class="subtitle" id="progressText">Ponto 1 de 9</p>
      <div class="progressbar" aria-hidden="true"><span id="progressBar"></span></div>
    </div>
  </header>

  <!-- POPUP/OVERLAY: dica de scroll -->
  <div class="scroll-overlay" id="scrollOverlay" aria-hidden="false">
    <div class="scroll-overlay__card">
      <p class="scroll-overlay__title" id="overlayTitle">Bem-vindo ✨</p>
      <p class="scroll-overlay__text" id="overlayText">Faz scroll para começares a descobrir o mapa</p>
      <div class="scroll-overlay__arrow" aria-hidden="true">↓</div>
    </div>
  </div>

  <div class="chapters">
    <!-- INTRO -->
    <section class="intro chapter" id="intro" aria-label="Introdução">
      <div class="intro-sticky">
        <div class="intro-top">
          <div class="intro-copy" aria-hidden="true">
            <h2 class="intro-title" id="introTitle">Segue a cidade<br/>ponto a ponto</h2>
            <p class="intro-sub" id="introSub">Ouve a história antes de entrar. Avança no percurso ao teu ritmo.</p>
          </div>
        </div>

        <!-- INTRO: mapa por camadas -->
        <div class="intro-visual">
          <div class="intro-map" aria-hidden="true">
            <img class="layer l1" src="assets/intro/01-background.webp" alt="" decoding="async" />
            <img class="layer l2" src="assets/intro/02-ruas.webp" alt="" decoding="async" />
            <img class="layer l3" src="assets/intro/03-elementos.webp" alt="" decoding="async" />
            <img class="layer l4" src="assets/intro/04-percurso.webp" alt="" decoding="async" />
            <img class="layer l5" src="assets/intro/05-icones.webp" alt="" decoding="async" />
            <img class="layer l6" src="assets/intro/06-nomes.webp" alt="" decoding="async" />
          </div>
        </div>

        <div class="scroll-hint" id="scrollHint">Faz scroll</div>
      </div>
    </section>

    <!-- ROTA -->
    <section class="route chapter" id="routeChapter" aria-label="Rota">
      <main class="route-wrap is-hidden" id="route">
        <!-- MAPA sticky (visual IGUAL ao final da intro, sem “card”) -->
        <section class="route-map-sticky" aria-label="Mapa">
          <div class="route-map" id="routeMap" aria-hidden="false">
            <img class="route-map__layer" src="assets/intro/01-background.webp" alt="" decoding="async" />
            <img class="route-map__layer" src="assets/intro/02-ruas.webp" alt="" decoding="async" />
            <img class="route-map__layer" src="assets/intro/03-elementos.webp" alt="" decoding="async" />
            <img class="route-map__layer" src="assets/intro/04-percurso.webp" alt="" decoding="async" />
            <img class="route-map__layer" src="assets/intro/05-icones.webp" alt="" decoding="async" />
            <img class="route-map__layer" src="assets/intro/06-nomes.webp" alt="" decoding="async" />

            <div class="route-map__pins" id="routePins" aria-label="Marcadores"></div>
          </div>
        </section>

        <section class="tracks" aria-label="Lista de pontos">
          <div class="tracks-head">
            <h3 class="tracks-title" id="tracksTitle">Pontos</h3>
            <p class="tracks-sub" id="tracksSub">Toca num ponto para abrir ou ouvir o áudio.</p>
          </div>

          <div class="track-list" id="stopList"></div>

          <footer class="route-footer" aria-hidden="true">
            <div class="route-footer__line"></div>
            <p class="route-footer__copy" id="footerCopy">Postais por Lisboa — percurso interativo</p>
          </footer>
        </section>
      </main>
    </section>
  </div>

  <!-- Modal -->
  <div class="modal-backdrop" id="modalBackdrop" hidden>
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modal-head">
        <h2 id="modalTitle">Título</h2>
        <button class="icon-btn" id="closeModal" aria-label="Fechar">✕</button>
      </div>

      <p class="modal-meta" id="modalType"></p>

      <div class="modal-body">
        <p id="modalText"></p>

        <div class="audio-box">
          <p class="audio-label" id="audioLabel">Áudio</p>
          <audio id="modalAudio" controls preload="metadata"></audio>
        </div>
      </div>

      <div class="modal-actions">
        <button class="btn secondary" id="replayBtn">Repetir áudio</button>
        <button class="btn primary" id="continueBtn">Continuar percurso</button>
      </div>
    </div>
  </div>

  <script src="app.js" defer></script>
</body>
</html>
